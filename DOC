S√≠. Te dejo un esquema entidad‚Äìrelaci√≥n (ER) y luego el modelo m√°s √≥ptimo (normalizado, pensado para Oracle y para que escale bien) para el sistema de F√°brica de Repuestos del documento.  Ôøº

‚∏ª

Esquema ER propuesto (entidades y relaciones)

Usuarios y perfiles
	‚Ä¢	USER (1) ‚Äî‚Äî (N) USER_ADDRESS
	‚Ä¢	USER (1) ‚Äî‚Äî (0..1) ENTERPRISE_PROFILE (solo si es empresarial)
	‚Ä¢	USER (N) ‚Äî‚Äî (M) ROLE v√≠a USER_ROLE (si quer√©s permitir m√∫ltiples roles; si no, un role_id en USER)

Cat√°logo de repuestos
	‚Ä¢	PART (N) ‚Äî‚Äî (1) CATEGORY
	‚Ä¢	PART (N) ‚Äî‚Äî (1) BRAND (marca del repuesto; distinto a marca del veh√≠culo)
	‚Ä¢	PART (1) ‚Äî‚Äî (N) PART_IMAGE
	‚Ä¢	PART (1) ‚Äî‚Äî (N) PART_TECH_SPEC
	‚Ä¢	PART (N) ‚Äî‚Äî (M) VEHICLE v√≠a PART_COMPATIBILITY (compatibilidad por c√≥digo universal + marca/l√≠nea/a√±o)

Inventario y auditor√≠a
	‚Ä¢	PART (1) ‚Äî‚Äî (N) INVENTORY_MOVEMENT (entradas, ajustes; deja trazabilidad de cada alta)
	‚Ä¢	USER (1) ‚Äî‚Äî (N) INVENTORY_MOVEMENT (qui√©n lo hizo)

Pedidos / compras
	‚Ä¢	ORDER (N) ‚Äî‚Äî (1) USER (qui√©n compra: registrado o empresarial)
	‚Ä¢	ORDER (1) ‚Äî‚Äî (N) ORDER_ITEM ‚Äî‚Äî (N) PART
	‚Ä¢	ORDER (1) ‚Äî‚Äî (N) ORDER_STATUS_HISTORY (estado: iniciada ‚Üí preparaci√≥n ‚Üí enviado ‚Üí entregado, con comentario, tracking, ETA)
	‚Ä¢	ORDER (0..N) ‚Äî‚Äî (1) PAYMENT (si lo separ√°s; tambi√©n puede ser 1:1)

Comentarios y ratings
	‚Ä¢	PART (1) ‚Äî‚Äî (N) PART_REVIEW
	‚Ä¢	USER (1) ‚Äî‚Äî (N) PART_REVIEW
	‚Ä¢	PART_REVIEW (1) ‚Äî‚Äî (0..N) PART_REVIEW (self-relationship para comentarios multinivel / recursivos)

Integraci√≥n y logs de JSON
	‚Ä¢	USER (empresarial) (1) ‚Äî‚Äî (N) API_CREDENTIAL (si quer√©s credenciales separadas para REST)
	‚Ä¢	USER (1) ‚Äî‚Äî (N) JSON_OPERATION_LOG (export/import/carga masiva; qui√©n/cu√°ndo/archivo/resultado)

Reportes espec√≠ficos (evaluaci√≥n de mercado)
	‚Ä¢	ENTERPRISE_PROFILE (1) ‚Äî‚Äî (N) MARKET_FEED_CONFIG (endpoint por cliente empresarial)
	‚Ä¢	MARKET_FEED_CONFIG (1) ‚Äî‚Äî (N) MARKET_SALES_SNAPSHOT (lo que te mandan diario)
	‚Ä¢	MARKET_SALES_SNAPSHOT (N) ‚Äî‚Äî (1) PART (match por part_number, o con tabla de mapeo si no siempre calza)

‚∏ª

Modelo √≥ptimo de BD (tablas sugeridas)

1) Seguridad / Usuarios

USER
	‚Ä¢	user_id (PK)
	‚Ä¢	email (UNIQUE)
	‚Ä¢	password_hash
	‚Ä¢	full_name (opcional)
	‚Ä¢	phone (opcional)
	‚Ä¢	status (activo/bloqueado)
	‚Ä¢	created_at

ROLE
	‚Ä¢	role_id (PK) [ADMIN, REGISTERED, ENTERPRISE, ANON] (ANON no necesita tabla realmente)
	‚Ä¢	name

USER_ROLE (opcional si multi-rol; si no, role_id directo en USER)
	‚Ä¢	user_id (FK)
	‚Ä¢	role_id (FK)
	‚Ä¢	PK (user_id, role_id)

USER_ADDRESS
	‚Ä¢	address_id (PK)
	‚Ä¢	user_id (FK)
	‚Ä¢	line1, line2, city, state, zip, country
	‚Ä¢	is_default_shipping
	‚Ä¢	is_default_billing

ENTERPRISE_PROFILE
	‚Ä¢	enterprise_id (PK)
	‚Ä¢	user_id (FK UNIQUE) (1:1 con USER empresarial)
	‚Ä¢	default_shipping_address_id (FK)
	‚Ä¢	default_billing_address_id (FK)
	‚Ä¢	default_card_token (no guardes tarjeta en claro; tokeniza)
	‚Ä¢	delivery_window (texto/JSON simple)
	‚Ä¢	discount_percent (configurable por admin)

√ìptimo: tokenizar tarjeta o guardar solo last4 + token externo. En el documento piden tarjeta, pero lo ‚Äú√≥ptimo‚Äù es no guardar PAN/CVV.

‚∏ª

2) Cat√°logo

CATEGORY
	‚Ä¢	category_id (PK)
	‚Ä¢	name
	‚Ä¢	parent_id (FK a CATEGORY) (si quer√©s categor√≠as jer√°rquicas)

BRAND (marca del repuesto)
	‚Ä¢	brand_id (PK)
	‚Ä¢	name

VEHICLE
	‚Ä¢	vehicle_id (PK)
	‚Ä¢	universal_vehicle_code (INDEX)
	‚Ä¢	make (marca veh√≠culo)
	‚Ä¢	line (l√≠nea)
	‚Ä¢	year
	‚Ä¢	UNIQUE (universal_vehicle_code, year) (o lo que aplique)

PART
	‚Ä¢	part_id (PK)
	‚Ä¢	category_id (FK)
	‚Ä¢	brand_id (FK)
	‚Ä¢	part_number (UNIQUE) (n√∫mero de parte)
	‚Ä¢	title
	‚Ä¢	description
	‚Ä¢	weight_lb
	‚Ä¢	price
	‚Ä¢	active (bool)
	‚Ä¢	created_at

PART_IMAGE
	‚Ä¢	image_id (PK)
	‚Ä¢	part_id (FK)
	‚Ä¢	url/path
	‚Ä¢	sort_order
	‚Ä¢	CHECK (m√°x 3 por part) (esto se controla mejor desde app, pero se puede validar con trigger)

PART_TECH_SPEC
	‚Ä¢	spec_id (PK)
	‚Ä¢	part_id (FK)
	‚Ä¢	spec_name
	‚Ä¢	spec_value
	‚Ä¢	INDEX (part_id)

PART_COMPATIBILITY
	‚Ä¢	part_id (FK)
	‚Ä¢	vehicle_id (FK)
	‚Ä¢	PK (part_id, vehicle_id)

‚∏ª

3) Inventario (con trazabilidad real)

INVENTORY_MOVEMENT
	‚Ä¢	movement_id (PK)
	‚Ä¢	part_id (FK)
	‚Ä¢	user_id (FK) (qui√©n hizo la operaci√≥n)
	‚Ä¢	movement_type (INBOUND, ADJUSTMENT, OUTBOUND_RESERVED, OUTBOUND_SOLD) (si quer√©s full control)
	‚Ä¢	quantity (+/-)
	‚Ä¢	reference (ej: ‚ÄúCarga masiva JSON #123‚Äù)
	‚Ä¢	created_at

PART_STOCK (tabla ‚Äúcache‚Äù opcional para consultas r√°pidas)
	‚Ä¢	part_id (PK/FK)
	‚Ä¢	on_hand_qty
	‚Ä¢	reserved_qty
	‚Ä¢	updated_at

√ìptimo: mantener trazabilidad en INVENTORY_MOVEMENT y tener PART_STOCK como resumen.
La alerta de ‚Äú<=5‚Äù sale de on_hand_qty - reserved_qty.

‚∏ª

4) Pedidos

ORDER_HEADER
	‚Ä¢	order_id (PK)
	‚Ä¢	order_number (UNIQUE) (visible al usuario)
	‚Ä¢	user_id (FK)
	‚Ä¢	order_type (WEB / ENTERPRISE_API)
	‚Ä¢	subtotal
	‚Ä¢	shipping_total
	‚Ä¢	total
	‚Ä¢	currency
	‚Ä¢	created_at

ORDER_ITEM
	‚Ä¢	order_item_id (PK)
	‚Ä¢	order_id (FK)
	‚Ä¢	part_id (FK)
	‚Ä¢	qty
	‚Ä¢	unit_price
	‚Ä¢	line_total

ORDER_STATUS_HISTORY
	‚Ä¢	status_id (PK)
	‚Ä¢	order_id (FK)
	‚Ä¢	status (INITIATED, PREPARING, SHIPPED, DELIVERED)
	‚Ä¢	comment
	‚Ä¢	tracking_number (nullable)
	‚Ä¢	eta_days (nullable)
	‚Ä¢	changed_by_user_id (FK)
	‚Ä¢	changed_at

PAYMENT
	‚Ä¢	payment_id (PK)
	‚Ä¢	order_id (FK)
	‚Ä¢	method (CARD)
	‚Ä¢	amount
	‚Ä¢	auth_code / reference
	‚Ä¢	payment_status
	‚Ä¢	created_at

‚∏ª

5) Reviews multinivel

PART_REVIEW
	‚Ä¢	review_id (PK)
	‚Ä¢	part_id (FK)
	‚Ä¢	user_id (FK)
	‚Ä¢	parent_review_id (FK a PART_REVIEW, nullable)
	‚Ä¢	rating (0..5)
	‚Ä¢	comment_text
	‚Ä¢	created_at
	‚Ä¢	INDEX (part_id), INDEX(parent_review_id)

‚∏ª

6) Logs (JSON import/export + carga masiva)

JSON_OPERATION_LOG
	‚Ä¢	op_id (PK)
	‚Ä¢	user_id (FK)
	‚Ä¢	op_type (EXPORT_PARTS, IMPORT_PARTS, BULK_INVENTORY_LOAD)
	‚Ä¢	file_name / file_path / checksum
	‚Ä¢	success_count
	‚Ä¢	error_count
	‚Ä¢	error_detail (CLOB) (o tabla separada si quer√©s granular)
	‚Ä¢	created_at

‚∏ª

7) Reporte evaluaci√≥n de mercado (del documento)

MARKET_FEED_CONFIG
	‚Ä¢	feed_id (PK)
	‚Ä¢	enterprise_id (FK)
	‚Ä¢	endpoint_url
	‚Ä¢	auth_type / token (si aplica)
	‚Ä¢	active
	‚Ä¢	created_at

MARKET_SALES_SNAPSHOT
	‚Ä¢	snapshot_id (PK)
	‚Ä¢	feed_id (FK)
	‚Ä¢	snapshot_date
	‚Ä¢	part_number (texto recibido)
	‚Ä¢	part_name (texto recibido)
	‚Ä¢	qty
	‚Ä¢	unit_price
	‚Ä¢	currency
	‚Ä¢	received_at
	‚Ä¢	INDEX (snapshot_date), INDEX(part_number)

(Opcional) PART_NUMBER_MAP
	‚Ä¢	map_id (PK)
	‚Ä¢	part_number_external
	‚Ä¢	part_id (FK)
	‚Ä¢	feed_id (FK nullable)
	‚Ä¢	UNIQUE(part_number_external, feed_id)

‚∏ª

Decisiones ‚Äú√≥ptimas‚Äù importantes (para que quede pro)
	1.	Normalizaci√≥n hasta 3FN en cat√°logo (specs, im√°genes, compatibilidad en tablas separadas).
	2.	Inventario por movimientos + stock resumido: te da auditor√≠a y performance a la vez.
	3.	Estados del pedido como historial, no solo un campo: cumple ‚Äúcomentario por fase‚Äù + tracking + ETA.
	4.	Reviews multinivel con parent_review_id (self FK).
	5.	√çndices clave:
	‚Ä¢	PART(part_number)
	‚Ä¢	VEHICLE(universal_vehicle_code, year)
	‚Ä¢	PART_COMPATIBILITY(part_id, vehicle_id)
	‚Ä¢	ORDER_HEADER(user_id, created_at)
	‚Ä¢	ORDER_STATUS_HISTORY(order_id, changed_at)
	‚Ä¢	MARKET_SALES_SNAPSHOT(snapshot_date, part_number)
	6.	No guardar tarjeta en claro: token o vault; si te obligan, m√≠nimo last4 + token.

‚∏ª

Perfecto üôå te voy a consolidar todo lo relacionado al sistema de la F√°brica de Repuestos (Fabricantes de partes de veh√≠culos ‚Äì B2B) seg√∫n el documento que compartiste  Ôøº, pero organizado y estructurado para que lo puedas usar en:
	‚Ä¢	Documento de requerimientos
	‚Ä¢	Project Charter
	‚Ä¢	Dise√±o de arquitectura
	‚Ä¢	Presentaci√≥n
	‚Ä¢	Manual t√©cnico

‚∏ª

üè≠ SISTEMA: F√ÅBRICA DE REPUESTOS DE VEH√çCULOS (B2B)

‚∏ª

üéØ 1. Objetivo del Sistema

El sistema de la f√°brica tiene como prop√≥sito:
	‚Ä¢	Vender repuestos de una marca espec√≠fica.
	‚Ä¢	Administrar cat√°logo e inventario.
	‚Ä¢	Recibir pedidos de distribuidoras.
	‚Ä¢	Recibir pagos.
	‚Ä¢	Exponer servicios REST para integraci√≥n con sistemas externos.
	‚Ä¢	Generar reportes estrat√©gicos y operativos.

Forma parte del ecosistema B2B donde interact√∫a con sistemas de distribuidoras/ventas de repuestos  Ôøº.

‚∏ª

üß© 2. M√≥dulos del Sistema de F√°brica

El sistema de f√°brica incluye:
	1.	M√≥dulos Globales
	2.	M√≥dulos Espec√≠ficos de Fabricante
	3.	Integraci√≥n REST Empresarial
	4.	Reportes Espec√≠ficos
	5.	Tecnolog√≠as

‚∏ª

üë§ 3. M√ìDULOS GLOBALES

3.1 M√≥dulo de Usuarios

Tipos de usuario:
	1.	Administrador / Empleado
	2.	Empresarial
	3.	Visitante an√≥nimo
	4.	Visitante registrado

Funcionalidades clave:

üîπ Visitante An√≥nimo
	‚Ä¢	Ver cat√°logo
	‚Ä¢	Ver comentarios
	‚Ä¢	No puede comprar
	‚Ä¢	Puede registrarse (email + password + direcci√≥n + captcha)

üîπ Usuario Registrado
	‚Ä¢	Puede comprar
	‚Ä¢	Puede dejar comentarios y ratings
	‚Ä¢	Puede ver historial de pedidos

üîπ Usuario Empresarial
	‚Ä¢	Es asignado por administrador
	‚Ä¢	Tiene descuento configurable
	‚Ä¢	Puede:
	‚Ä¢	Ver compras empresariales
	‚Ä¢	Ver estado de env√≠o
	‚Ä¢	Configurar:
	‚Ä¢	Direcci√≥n default
	‚Ä¢	Tarjeta default
	‚Ä¢	Horario de entrega

üîπ Administrador

Puede:
	‚Ä¢	Administrar cat√°logo
	‚Ä¢	Administrar portal web
	‚Ä¢	Administrar reportes
	‚Ä¢	Cambiar roles de usuarios
	‚Ä¢	Configurar descuentos empresariales

‚∏ª

üì¶ 4. M√ìDULO DE ADMINISTRACI√ìN Y CAT√ÅLOGO

Este es uno de los m√≥dulos m√°s importantes del sistema de f√°brica.

Campos obligatorios del repuesto:
	‚Ä¢	1 a 3 fotograf√≠as
	‚Ä¢	Categor√≠a
	‚Ä¢	Marca
	‚Ä¢	N√∫mero de parte
	‚Ä¢	L√≠nea
	‚Ä¢	A√±o
	‚Ä¢	C√≥digo universal de veh√≠culo
	‚Ä¢	T√≠tulo
	‚Ä¢	Descripci√≥n
	‚Ä¢	Peso
	‚Ä¢	Caracter√≠sticas t√©cnicas (tipo + valor)
	‚Ä¢	Precio

üß† Veh√≠culos

Se clasifican por:
	‚Ä¢	Marca
	‚Ä¢	L√≠nea
	‚Ä¢	A√±o
	‚Ä¢	C√≥digo universal (mismo c√≥digo entre fabricantes)

‚∏ª

üìä Inventario

El administrador puede:
	‚Ä¢	Agregar inventario a un repuesto
	‚Ä¢	Registrar cada alta de inventario
	‚Ä¢	Mostrar alerta si hay ‚â§ 5 unidades
	‚Ä¢	Impedir compra si no hay inventario

‚∏ª

üìÅ Importaci√≥n / Exportaci√≥n JSON

El administrador puede:
	‚Ä¢	Exportar repuestos a JSON
	‚Ä¢	Importar JSON (sobreescribe datos)
	‚Ä¢	Carga masiva de inventario por JSON

Debe existir:
	‚Ä¢	Log de operaciones
	‚Ä¢	Qui√©n hizo la operaci√≥n
	‚Ä¢	Cu√°ndo
	‚Ä¢	Archivo usado
	‚Ä¢	Cu√°ntos exitosos
	‚Ä¢	Cu√°ntos con error

‚∏ª

üõí 5. M√ìDULO DE COMPRA Y PEDIDOS

Permite:
	‚Ä¢	M√∫ltiples repuestos en un pedido
	‚Ä¢	Generar n√∫mero de orden de compra

‚∏ª

üîÑ Flujo de Pedido
	1.	Orden iniciada
	2.	Preparaci√≥n
	3.	Enviado
	4.	Entregado

El administrador puede:
	‚Ä¢	Cambiar estado
	‚Ä¢	Agregar comentarios
	‚Ä¢	Agregar tracking number
	‚Ä¢	Agregar tiempo estimado de entrega (o usar default global)

‚∏ª

üñ• Compras por Portal Web

El usuario puede:
	‚Ä¢	Agregar al carrito
	‚Ä¢	Quitar del carrito
	‚Ä¢	Modificar cantidad
	‚Ä¢	Ver subtotal
	‚Ä¢	Ver env√≠o
	‚Ä¢	Ver total

Checkout solicita:
	‚Ä¢	Direcci√≥n env√≠o
	‚Ä¢	Tarjeta
	‚Ä¢	CVV
	‚Ä¢	Nombre
	‚Ä¢	Direcci√≥n de cobro

Al finalizar:
	‚Ä¢	Historial de pedidos
	‚Ä¢	Detalle
	‚Ä¢	Recibo descargable

‚∏ª

üîó Compras por Integraci√≥n Empresarial

Se realizan v√≠a servicios REST.

‚∏ª

üåê 6. M√ìDULO DE INTEGRACI√ìN REST (CLIENTES EMPRESARIALES)

Este es el m√≥dulo clave del B2B.

El sistema debe exponer endpoints REST en JSON.

‚∏ª

üîê Seguridad
	‚Ä¢	Solo usuarios empresariales autenticados
	‚Ä¢	Validaci√≥n por password
	‚Ä¢	Si no est√° autenticado ‚Üí error

‚∏ª

üìå Servicios obligatorios

1Ô∏è‚É£ Servicio de Pedido

Recibe:
	‚Ä¢	Datos del usuario final
	‚Ä¢	Lista de repuestos

Usa:
	‚Ä¢	Direcci√≥n default empresarial
	‚Ä¢	Tarjeta default empresarial

Responde:
	‚Ä¢	JSON con:
	‚Ä¢	Orden de compra
	‚Ä¢	Fecha
	‚Ä¢	Detalle completo

Debe poder consultarse luego v√≠a REST.

‚∏ª

2Ô∏è‚É£ Servicio de B√∫squeda

Recibe:
	‚Ä¢	Nombre
	‚Ä¢	Descripci√≥n
	‚Ä¢	Especificaciones

Responde:
	‚Ä¢	Lista de repuestos
	‚Ä¢	C√≥digo de repuesto

‚∏ª

3Ô∏è‚É£ Servicio de Detalle

Recibe:
	‚Ä¢	C√≥digo de repuesto

Responde:
	‚Ä¢	Todos los datos del repuesto

‚∏ª

üìà 7. M√ìDULO DE REPORTES ESPEC√çFICOS

üìä Reporte Evaluaci√≥n de Mercado

Diariamente el sistema:
	‚Ä¢	Consulta endpoint de clientes empresariales
	‚Ä¢	Recibe JSON con:
	‚Ä¢	N√∫mero de parte
	‚Ä¢	Nombre
	‚Ä¢	Cantidad vendida
	‚Ä¢	Precio unitario

El sistema:
	‚Ä¢	Guarda datos localmente
	‚Ä¢	Consolida informaci√≥n
	‚Ä¢	Compara precios

‚∏ª

üìä Reporter√≠a adicional
	‚Ä¢	Ventas
	‚Ä¢	Repuestos consultados
	‚Ä¢	Repuestos vistos en detalle
	‚Ä¢	Repuestos agregados a carrito

‚∏ª

üñ• 8. M√ìDULO PORTAL WEB

Administrador puede configurar:

Globales:
	‚Ä¢	Header
	‚Ä¢	Footer

Home:
	‚Ä¢	Carrusel promociones
	‚Ä¢	Categor√≠as

Categor√≠a:
	‚Ä¢	Filtros:
	‚Ä¢	Marca
	‚Ä¢	L√≠nea
	‚Ä¢	A√±o
	‚Ä¢	Precio
	‚Ä¢	Rating
	‚Ä¢	Ordenamientos

Repuesto:
	‚Ä¢	Galer√≠a
	‚Ä¢	Detalle
	‚Ä¢	Rating
	‚Ä¢	Comentarios multinivel
	‚Ä¢	Bot√≥n agregar carrito (solo si hay stock)

Checkout

Paso a paso guiado

Detalle pedidos

Historial completo

‚∏ª

üß† 9. TECNOLOG√çAS OBLIGATORIAS

Para F√°brica de Repuestos:
	‚Ä¢	Base de datos: Oracle
	‚Ä¢	Backend: Java (NO Spring)
	‚Ä¢	Frontend: stack aprobado por catedr√°tico
	‚Ä¢	Servidores: Linux
	‚Ä¢	Webservices: REST en JSON

‚∏ª

‚öôÔ∏è 10. REGLAS ARQUITECT√ìNICAS IMPORTANTES
	‚Ä¢	Cada sistema tiene su propia base de datos.
	‚Ä¢	Comunicaci√≥n solo backend a backend.
	‚Ä¢	No llamadas frontend a otros sistemas.
	‚Ä¢	M√≠nimo 2 f√°bricas en el ecosistema.
	‚Ä¢	Comunicaci√≥n solo por REST.
	‚Ä¢	Buenas pr√°cticas obligatorias.

‚∏ª

üìö 11. ENTREGABLES RELACIONADOS A ESTE SISTEMA

Para la f√°brica debes entregar:
	‚Ä¢	Project Charter
	‚Ä¢	Documento de requerimientos funcionales y no funcionales
	‚Ä¢	10 historias de usuario por miembro
	‚Ä¢	An√°lisis de riesgos
	‚Ä¢	Pruebas unitarias (Java)
	‚Ä¢	Manual t√©cnico
	‚Ä¢	Manual de usuario
	‚Ä¢	Documentaci√≥n de webservices
	‚Ä¢	Diagrama entidad-relaci√≥n
	‚Ä¢	Plataforma funcional en servidor independiente

‚∏ª

üß© RESUMEN GENERAL DEL SISTEMA DE F√ÅBRICA

El sistema de f√°brica:
	‚Ä¢	Administra repuestos
	‚Ä¢	Controla inventario
	‚Ä¢	Recibe pedidos
	‚Ä¢	Expone API REST
	‚Ä¢	Gestiona clientes empresariales
	‚Ä¢	Consolida reportes de mercado
	‚Ä¢	Se comunica con m√∫ltiples distribuidoras
	‚Ä¢	Funciona como n√∫cleo proveedor del ecosistema B2B

‚∏ª
